# 文本格式化工具-从markdown格式转换为电影staff表记排版

这是一个用Python编写的文本格式化工具,主要用于处理和格式化文本文件,特别适合处理包含中文和英文混合的文本内容。

## 输入参考：
``` 
# 演出人员
## 节目一
张三
李四
john
trsty
## 节目二
王五
赵六

# 后勤人员
## 舞台布置
孙七
周八
## 道具管理
吴九
郑十
张十一
李十二
王世山
吴九
郑十
张十一
```

##输出示例
![image](https://github.com/user-attachments/assets/d566ade3-da4e-4fe3-920f-911f8db6f4eb)
此为粘贴到剪映后的效果


## 功能特点

- 支持多种对齐方式(左对齐、居中对齐、右对齐)
- 智能处理中英文混合文本(中文字符占2个宽度)
- 支持段落和标题的格式化
- 弹性宽度自适应
- 左右拉齐模式
- 保持原文件的段落结构

## 使用方法

1. 运行程序后,按照提示输入以下信息:
   - 输入文件路径
   - 每行最大字符宽度
   - 对齐方式选择
   - 是否启用左右拉齐模式
   - 是否启用弹性宽度

2. 程序会自动在原文件同目录下生成格式化后的文件,文件名为"原文件名_formatted.扩展名"

## 参数说明

### 对齐方式
- 1: 左对齐
- 2: 居中对齐
- 3: 右对齐

### 左右拉齐模式
- 启用后,文本将被强制拉伸至指定宽度
- 适合需要整齐版面的场合

### 弹性宽度
- 启用后,程序会根据内容自动调整实际使用的宽度
- 可以避免过宽的留白

## 注意事项

1. 输入文件必须是UTF-8编码的文本文件
2. 标题行需要以#开头(支持多级标题)
3. 空行会被保留用于分隔段落
4. 中文字符计算宽度时会被视为2个单位
5. 确保有足够的行宽来容纳最长的单个词条

## 错误处理

程序包含完整的错误处理机制,常见错误包括:
- 文件路径无效
- 宽度设置不合理
- 对齐方式选择错误

## 技术实现

- 使用Python的unicodedata模块处理中英文字符宽度
- 支持文件的自动创建和错误处理
- 智能段落分析和格式化算法

## 系统要求

- Python 3.6+
- 无需额外依赖包
